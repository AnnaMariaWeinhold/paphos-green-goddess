---
//import components and layouts
import MainLayout from '../../layouts/MainLayout.astro';
import Section from '../../components/Section.astro';

//import sanity
import { useSanityClient } from 'astro-sanity';
import { urlForImage } from '../../lib/urlForImage';
import PortableText from '../../components/PortableText.astro';



export async function getStaticPaths() {
  const posts = await useSanityClient().fetch(`*[_type == "post"]`);

  console.log(posts);
  return posts
    .map((post) => {
      return post.slug?.current
        ? {
            params: {
              slug: post.slug?.current
            },
            props: { ...post }
          }
        : null;
    })
    .filter(Boolean);
}

const { title, body, mainImage, author, publishedAt } = Astro.props;
---
<MainLayout
title="Water harvesting in Cyprus"
description="XXX"
>
<h1 class="post__title">{title}</h1>
<div class="featured-img__container">
  {
    mainImage && (
      <img class="post__featured-img" src={urlForImage(mainImage).url()} />
    )
  } 
  </div>
  <div class="mid">
  <PortableText portableText={body} />
  </div>

</MainLayout>

<style>
.post__title {
  text-align: center;
  margin-top: 1.5em;
}

.post__featured-img {
  width: 50%;
  margin: 4em auto;
  display: flex;
  align-self: center;
  border-radius: 30% 40% 40% 40%;
}

.mid {
  margin: 0 auto;
  max-width: 730px;
}
</style>