---
import { useSanityClient } from 'astro-sanity';
import { urlForImage } from '../../lib/urlForImage';
import PortableText from '../../components/PortableText.astro';



export async function getStaticPaths() {
  const posts = await useSanityClient().fetch(`*[_type == "post"]`);

  console.log(posts);
  return posts
    .map((post) => {
      return post.slug?.current
        ? {
            params: {
              slug: post.slug?.current
            },
            props: { ...post }
          }
        : null;
    })
    .filter(Boolean);
}

const { title, body, mainImage, author, publishedAt } = Astro.props;
---

<h1>{title}</h1>
<div class="featured-img__container">
  {
    mainImage && (
      <img class="post__featured-img" src={urlForImage(mainImage).url()} />
    )
  } 
  </div>
<div class="mid">
  <PortableText portableText={body} />
  </div>